# Command vs ENTRYPOINT
## Command
ধরা যাক আমরা একটা ubuntu ইমেজ থেকে একটি ডকার কন্টেইনার রান করাবো। আমরা যখন docker run ubuntu কমান্ডটি রান করি তখন এটি ubuntu ইমেজের একটি ইন্সটেন্স রান করে সাথে সাথে এক্সিট করে। docker ps কমান্ডটি রান করলে দেখা যাবে কন্টেইনারটিব আর রান করছে না। docker ps -a কমান্ডটি রান করলে দেখা যায় ubuntu ইমেজের কন্টেইনারটি exited স্টেটে আছে। 

img1![1](https://user-images.githubusercontent.com/61577824/168756883-f13229c3-fb81-407a-875a-e5086cec4ba4.png)



এমনটি কেন হয়? ভার্চুয়াল মেশিনের মত কন্টেইনার কোনো অপারেটিং সিস্টেম হোস্ট করে না। কন্টেইনার কোনো স্পেসিফিক টাস্ক বা প্রসেস রান করে যেমন: ওয়েব বা এপ্লিকেশন সার্ভার বা ডেটাবেজ এর ইন্সটেন্স হোস্ট করা বা কোনো কম্পিউটেশন করা। টাস্ক বা প্রসেস কম্পলিট হওয়ার সাথে সাথে কন্টেইনার এক্সিট করে। তো কোনো কন্টেইনারের মধ্যে কোন প্রসেস রান হবে তা কে নির্দিষ্ট করে দেয়? আমরা যদি NGINX এর মত পপুলার ডকার ইমেজের ডকার ফাইলের দিকে লক্ষ্য করি তাহলে <b>CMD </b> নামে একটি ইন্সট্রাকশন খেয়াল করব। CMD যার পূর্ণরূপ হল command, কন্টেইনারের মধ্যে কোন প্রেসেস রান করবে তা নির্দিষ্ট করে দেয়। নিচের ছবিতে দেখা যাচ্ছে NGINX ইমেজের জন্য <b>nginx</b> এবং MYSQL ইমেজের জন্য <b>mysqld</b> কমান্ড রান করে। 

img2
![2](https://user-images.githubusercontent.com/61577824/168756980-738bdec7-bfaf-41d1-9f96-1ed9c0bfc52a.png)


আমরা শুরুতে যখন docker run ubuntu কমান্ডটি রান করেছি তখন কন্টেইনারে একটি ubuntu OS রান করেছে যার ডিফল্ট  cmd হল bash. bash কোনো প্রসেস না। এটি একটি shell যা terminal থেকে ইনপুট নেয় আর terminal খুঁজে না পেলে এক্সিট করে। ডকার কন্টেইনারের সাথে কোনো টার্মিনাল যুক্ত করে না। ফলস্বরূপ bash কমান্ডটি কোনো terminal খুঁজে না পেয়ে এক্সিট করে। কন্টেইনারটির ভিতরে তখন কোনো রানিং প্রেসেস না থাকায় কন্টেইনারও এক্সিট করে। তো একটি কন্টেইনার রান করার সময় কিভাবে কমান্ড বদলানো যায়? docker run কমান্ডটির সাথে এক্সট্রা কমান্ড যুক্ত করলে এটি ডিফল্ট কমান্ডকে প্রতিস্থাপন করে। যেমন:

```
docker run ubuntu sleep 5
```
এখানে sleep 5 হল এক্সট্রা কমান্ড যার কারণে কন্টেইনারটি ৫ সেকেন্ড যাবত  sleep প্রসেস রান করে। এর ফলে কন্টেইনারটি ৫ সেকেন্ড alive থাকে। কিন্তু এই কমান্ডটি কিভাবে স্থায়ী করা যায়? অর্থাৎ আমরা চাচ্ছি প্রতিবার ubuntu ইমেজ রান করলে যাতে sleep কমান্ডটি এক্সিকিউট হয়। এটি করার জন্য base ubuntu ইমেজ থেকে নিজস্ব একটি ইমেজ তৈরি করে নিতে হবে এবং নতুন কমান্ড নির্দিষ্ট করে দিতে হবে। বিভিন্নভাবে কমান্ড নির্দিষ্ট করে দেয়া যায়, যেমন: shell form বা json array format. 

img3
![3](https://user-images.githubusercontent.com/61577824/168757000-986ce075-61f6-4714-a29d-327f785caacc.png)


তারপর ডকার ফাইলটি বিল্ড করে রান করলে প্রতিবার আমরা একই ফলাফল পাবো। 
```
docker build -t ubuntu-sleeper .
docker run ubuntu-sleeper
```
এখানে ubuntu-sleeper হল ডকার ফাইলটির নাম। বর্তমানে ৫ সেকেন্ড সময় হার্ডকোডেড করা আছে। সময়কে ডায়নামিক, অর্থাৎ ইউজারের কাছ থেকে ইনপুট হিসেবে নেয়ার জন্য আমরা ENTRYPOINT ব্যবহার করব।

## ENTRYPOINT
আমরা এখন ডকার ফাইলটিতে CMD এর বদলে ENTRYPOINT ব্যবহার করব।

```
ENTRYPOINT ["sleep"]
```
উপরোক্ত কমান্ডটির মাধ্যমে আমরা sleep কমান্ডটি ফাইলে যুক্ত করে দিয়েছি। এর ফলে ডকার ফাইলটি রান করার সময় আলাদাভাবে sleep কমান্ডটি দেয়ার প্রয়োজন নেই, শুধুমাত্র সময় ইনপুট দিলেই হবে। যেমন:
```
docker run ubuntu-sleeper 10
```
এই কমান্ডটির মাধ্যমে ডকার ফাইলটির sleep কমান্ড ১০ সেকেন্ড রান করবে ফলে ডকার ফাইলটি ১০ সেকেন্ড ধরে alive state এ থাকবে। আমরা যদি ubuntu-sleeper রান করতে গিয়ে time নির্দিষ্ট করে না দেই তাহলে কি ঘটবে? অর্থাৎ যদি নিম্নোক্ত কমান্ডটি রান করি:
```
docker run ubuntu-sleeper
```
এক্ষেত্রে আমরা missing operand নামে একটি error message er সম্মুখীন হব:
```
sleep: missing operand
Try 'sleep --help' for more information
```
img4
![4](https://user-images.githubusercontent.com/61577824/168757015-ce891848-a9ef-4516-8b44-2d77a5c79c08.png)


এই সমস্যা থেকে উত্তরণের জন্য একটি নির্দিষ্ট ভ্যালু নির্দিষ্ট করে দেয়া দরকার। এজন্য ENTRYPOINT এবং CMD ইন্সট্রাকশন একসাথে ব্যবহার করতে হবে:
```
FROM ubuntu
ENTRYPOINT ["sleep"]
CMD ["5"]
```
এখানে CMD কমান্ডটির মাধ্যমে ৫ সেকেন্ড টাইম নির্দিষ্ট করে দেয়া হয়েছে। ফলে ইউজার কোনো টাইম ইনপুট না দিলে ডকার ফাইলটি বাই ডিফল্ট ৫ সেকেন্ড alive state এ থাকবে। আবার টাইম ইনপুট দিলে সেট করা ৫ সেকেন্ড টাইমটি ইউজারের ইনপুট দেয়া টাইম দ্বারা প্রতিস্থাপিত হবে। আমরা চাইলে runtime এ ENTRYPOINT কমান্ডটিও প্রতিস্থাপন করতে পারি। ধরা যাক আমাদের কাছে sleep2 নামে একটি কাল্পনিক কমান্ড আছে এবং আমরা sleep কমান্ডকে sleep2 কমান্ড দ্বারা প্রতিস্থাপিত করতে চাচ্ছি। নিচের কমান্ডটি রান করার মাধ্যমে আমরা সহজেই কাজটি করতে পারি:
```
docker run --entrypoint sleep2 ubuntu-sleeper
```
