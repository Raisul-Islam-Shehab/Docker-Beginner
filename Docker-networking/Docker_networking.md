এবারে আমরা Docker Networking এর ব্যাপারে আরো কিছু জানব...
---

যখনই আমরা Docker ইনস্টল করি তখনই ডিফল্ট হিসেবে ৩ টা নেটওয়ার্ক তৈরি হয়ে যায়। সেগুলো হলো ```Bridge```, ```Null``` এবং ```Host```. ```Bridge``` হচ্ছে ডিফল্ট নেটওয়ার্ক, যেটায় একটি Container এটাচড হয়ে থাকে। যদি আমরা Container টাকে অন্য কোনো নেটওয়ার্কের সাথে যোগ করতে চাই তাহলে আমাদের কে সেটা কমান্ডে --network প্যারামিটার দ্বারা উল্লেখ করে দিতে হবে।

```docker run ubuntu –-network=none```

```docker run ubuntu --network=host```

এখন আমরা প্রত্যেকটা নেটওয়ার্ক সম্পর্কে আলাদা ভাবে জানবো।...
---
প্রথমেই আসি Bridge নিয়ে। Bridge হলো একটি প্রাইভেট ইন্টারনাল নেটওয়ার্ক যেটা Docker, হোস্টের ভেতরে তৈরি করে। সব Container ই ডিফল্ট হিসেবে এটার সাথে সংযুক্ত থাকে এবং তারা প্রত্যেকেই একটি ```Internal IP``` পেয়ে থাকে, যা সাধারণত ```172.17``` সিরিজের হয়। Container সমূহ প্রয়োজনে নিজেদের মধ্যে এই IP address এর মাধ্যমে যোগাযোগ স্থাপন করতে পারে। উক্ত Container গুলো কে বাইরে থেকে একসেস করতে হলে এসব Container এর পোর্টগুলোকে Docker host এর ভিন্ন ভিন্ন পোর্টের সাথে ম্যাপ করে দিতে হবে, যা আমরা আগেই দেখে এসেছি।

Host নেটওয়ার্কের ব্যাবহার... 
---
কোনো Container কে বাইরে থেকে একসেস করার আরেকটি পদ্ধতি হচ্ছে, হোস্টের সাথে Container টিকে যুক্ত করে দেয়া। এর মাধ্যমে হোস্ট আর Container আর আলাদা ভাবে থাকে না। অর্থাৎ আমরা যদি কোনো ওয়েব এপ্লিকেশন ```Port:5000``` এ রান করে থাকি তাহলে সেটা হোস্টেরও ```Port:5000``` থেকেই একসেস পাওয়া যাবে কোনো প্রকার ম্যাপিং করা ছাড়াই কারণ Container টি হোস্টেরই পোর্ট ব্যাবহার করছে। এর ফলে যেটা হবে, আমরা আর আগের মতো একই হোস্টের একই পোর্টে একের অধিক Container রান করতে পারব না। কারণ এখন এই হোস্টের উক্ত পোর্ট টা সব Container এর জন্যই কমন হয়ে যাবে।

```docker run Ubuntu --network=host```

![host](/Docker-networking/host.png)

None নেটওয়ার্কের ব্যাবহার...
--- 
এই ধরনের নেটওয়ার্কে Container টি কোনো নেটওয়ার্কেই যুক্ত থাকে না। যার ফলে বাইরের কোনো নেটওয়ার্ক বা অভ্যন্তরীণ কোনো Container এর সাথে এর কোনো যোগাযোগ থাকে না। অর্থাৎ সম্পূর্ণ বিচ্ছিন্ন অবস্থায় থাকে।

```docker run Ubuntu –-network=none```

![none](/Docker-networking/none.png)

আমরা জানি ডিফল্ট হিসেবে সব Container ই ```Bridge``` নেটওয়ার্ক ব্যাবহার করে পরস্পরের সাথে যুক্ত থাকে। এখন আমরা যদি এই নেটওয়ার্কের ভেতরে কিছু Container কে আলাদা করতে চাই, যেমনটা নিচের চিত্রে দেখাচ্ছে। আমরা চাইলে এরকম ইন্টারনাল নেটওয়ার্ক তৈরি করতে পারি, নিম্নোক্ত কমান্ডটি ব্যাবহার করে।

![separate](/Docker-networking/separate.png)

```
docker network create \
    –-driver bridge \
    -–subnet 182.18.0.0/16
    custom-isolated-network
```

এখানে আমরা প্রথমে নেটওয়ার্ক টা সিলেক্ট করেছি এরপর তার ```Subnet``` উল্লেখ করেছি এবং সবশেষে একটা নাম দিয়েছি আমাদের কাস্টম নেটওয়ার্কটি কে।

এখন আমরা ```docker run ls``` কমান্ডটি রান করলে নেটওয়ার্ক লিস্টে আমাদের তৈরিকৃত নেটওয়ার্কটি দেখতে পাবো |

![ls](/Docker-networking/ls.png)

এবারে আমরা জানব কিভাবে নেটওয়ার্ক সেটিংস এবং তৈরিকৃত Container এর IP Address দেখতে হয়।

```docker inspect blissful_hopper```

```docker inspect``` কমান্ডটি Container এর আইডি বা নাম সহ রান করলে ```Networks``` সেকশনে তার নেটওয়ার্কের ধরণ, IP Address, Mac Address ও অন্যান্য ইনফো পাওয়া যাবে। 

Container সমূহ যার যার নাম দিয়েই একে অপরকে একসেস করতে পারবে। যেমন, আমরা যদি একটি ```mysql container``` এর ডাটাবেজকে আমাদের ওয়েব এপ্লিকেশনটি থেকে একসেস করতে চাই তাহলে আমরা ইন্টারনাল IP Address ব্যাবহার করে সেটা করতে পারি যেটা এক্ষেত্রে যেটা ```172.17.0.3```.

```mysql.connect(172.17.0.3)```

কিন্তু এই পদ্ধতি সবসময় সেইফ না। কারণ সিস্টেম রি-বুট করা হলে প্রত্যেক Container এর IP Address বদলে যাওয়ার সম্ভাবনা কাজ করে। এই সমস্যার সমাধান হলো, IP Address এর বদলে ```Container name``` ব্যাবহার করে কানেক্ট করা। 

```mysql.connect( mysql )```

Docker এর নিজস্ব ```DNS server``` আছে, যার মাধ্যমে এই নাম থেকেই IP Address সে বের করে নিতে পারে। এই ```DNS server``` টি সবসময় ```127.0.0.11``` এ চলে। 

![dns](/Docker-networking/connect.png)

কিছু গুরুত্বপূর্ণ প্রশ্ন এখন মাথায় আসে...
---
* Docker কিভাবে এই নেটওয়ার্কিং প্রয়োগ করে থাকে?
* এর পেছনের টেকনোলজি টা কি?
* Container গুলো কিভাবে আলাদা আলাদা হয়ে থাকতে পারছে?

এখন আসি উত্তরের অংশে... Docker, ```Network namespaces``` ব্যাবহার করে প্রত্যেকটা Container এর জন্য আলাদা ```Namespace``` তৈরি করে। Docker এরপর ```Virtual Ethernet Pair``` ব্যাবহার করে Container গুলোকে সংযুক্ত করে।

![dns](/Docker-networking/dns.png)

আপাতত শুরু হিসেবে আমরা এতদূরই জানব নেটওয়ার্ক এর ব্যাপারে। পরের বিষয়গুলো উচ্চতর ধাপে আমরা জানতে পারব।